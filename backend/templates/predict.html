{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>ðŸ¤– Predict Machine Health</h2>
  <form id="predictForm">
    <input name="VS1" placeholder="Vibration" step="0.01" type="number" required>
    <input name="TS1" placeholder="Temp 1" step="0.01" type="number" required>
    <input name="TS2" placeholder="Temp 2" step="0.01" type="number" required>
    <input name="TS3" placeholder="Temp 3" step="0.01" type="number" required>
    <input name="TS4" placeholder="Temp 4" step="0.01" type="number" required>
    <button type="submit" class="predict-btn">Predict</button>
  </form>
  <h3 id="result"></h3>
  <canvas id="predictChart"></canvas>
</div>

<script>
const ctx = document.getElementById('predictChart').getContext('2d');
const chart = new Chart(ctx, {
  type: 'bar',
  data: { labels: ['VS1','TS1','TS2','TS3','TS4'], datasets: [{ label: 'Sensor Values', data: [0,0,0,0,0], backgroundColor: '#fbbf24' }] },
});
document.getElementById('predictForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const data = Object.fromEntries(new FormData(e.target));
  const res = await fetch('/predict',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
  const out = await res.json();
  document.getElementById('result').innerText = 'Prediction: '+out.prediction;
  chart.data.datasets[0].data = Object.values(data);
  chart.update();
});
</script>
{% endblock %}
